#!/usr/bin/env python3
import pandas as pd

# Load both files
df1 = pd.read_csv("tickers.csv")
df2 = pd.read_csv("tickers3_filterred_ibkr.csv")

# Normalize column name
if "symbol" in df1.columns:
    col = "symbol"
elif "Symbol" in df1.columns:
    col = "Symbol"
else:
    raise ValueError("tickers.csv missing symbol column")

# Merge + drop duplicates
merged = pd.concat([df1, df2], ignore_index=True)
merged = merged.drop_duplicates(subset=[col]).reset_index(drop=True)

# Save back
merged.to_csv("tickers.csv", index=False)
print(f"Merged {len(df1)} + {len(df2)} -> {len(merged)} unique tickers saved in tickers.csv")
